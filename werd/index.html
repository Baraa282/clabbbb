<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>قرآن كريم - صفحات المصحف</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #f0f2f5;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
            font-family: 'Amiri', serif;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 10px;
            padding: 20px;
        }

        .page-number {
            background: #fff;
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            color: #3498db;
        }

        .page-number:hover {
            background: #3498db;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .read-page {
            background: #2ecc71 !important;
            color: white !important;
            border-color: #27ae60 !important;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            direction: rtl;
            text-align: right;
        }

        .surah-title {
            font-size: 32px;
            color: #2ecc71;
            text-align: center;
            margin: 20px 0;
            font-weight: bold;
            font-family: 'Amiri', serif;
        }

        .aya-text {
            font-size: 28px;
            line-height: 2.2;
            color: #2c3e50;
            font-family: 'Amiri', serif;
        }

        .close-btn {
            float: left;
            cursor: pointer;
            font-size: 24px;
            color: #666;
        }

        .spinner {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            z-index: 1001;
        }

        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .mark-read-btn {
            background: #2ecc71;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
            float: left;
            transition: all 0.3s ease;
        }

        .unmark-btn {
            background: #e74c3c !important;
        }

        @media (max-width: 768px) {
            .page-number {
                padding: 10px;
                font-size: 14px;
            }
            
            .modal-content {
                font-size: 22px;
            }
            
            .surah-title {
                font-size: 28px;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Amiri&display=swap" rel="stylesheet">
</head>
<body>
    <div class="spinner" id="spinner"></div>
    <div class="container">
        <h1>Daily Quran Recitation</h1>
        <div class="calendar-grid" id="calendar"></div>
    </div>

    <div class="modal" id="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <div id="page-content" class="aya-text"></div>
            <button class="mark-read-btn" id="markBtn" onclick="togglePageMark()">تمت القراءة ✓</button>
        </div>
    </div>

    <script>
        let currentPage = null;
        const surahNames = {
            1: 'الفاتحة',
            2: 'البقرة',
            3: 'آل عمران',
            4: 'النساء',
            5: 'المائدة',
            6: 'الأنعام',
            7: 'الأعراف',
            8: 'الأنفال',
            9: 'التوبة',
            10: 'يونس',
            11: 'هود',
            12: 'يوسف',
            13: 'الرعد',
            14: 'إبراهيم',
            15: 'الحجر',
            16: 'النحل',
            17: 'الإسراء',
            18: 'الكهف',
            19: 'مريم',
            20: 'طه',
            21: 'الأنبياء',
            22: 'الحج',
            23: 'المؤمنون',
            24: 'النور',
            25: 'الفرقان',
            26: 'الشعراء',
            27: 'النمل',
            28: 'القصص',
            29: 'العنكبوت',
            30: 'الروم',
            31: 'لقمان',
            32: 'السجدة',
            33: 'الأحزاب',
            34: 'سبأ',
            35: 'فاطر',
            36: 'يس',
            37: 'الصافات',
            38: 'ص',
            39: 'الزمر',
            40: 'غافر',
            41: 'فصلت',
            42: 'الشورى',
            43: 'الزخرف',
            44: 'الدخان',
            45: 'الجاثية',
            46: 'الأحقاف',
            47: 'محمد',
            48: 'الفتح',
            49: 'الحجرات',
            50: 'ق',
            51: 'الذاريات',
            52: 'الطور',
            53: 'النجم',
            54: 'القمر',
            55: 'الرحمن',
            56: 'الواقعة',
            57: 'الحديد',
            58: 'المجادلة',
            59: 'الحشر',
            60: 'الممتحنة',
            61: 'الصف',
            62: 'الجمعة',
            63: 'المنافقون',
            64: 'التغابن',
            65: 'الطلاق',
            66: 'التحريم',
            67: 'الملك',
            68: 'القلم',
            69: 'الحاقة',
            70: 'المعارج',
            71: 'نوح',
            72: 'الجن',
            73: 'المزمل',
            74: 'المدثر',
            75: 'القيامة',
            76: 'الإنسان',
            77: 'المرسلات',
            78: 'النبأ',
            79: 'النازعات',
            80: 'عبس',
            81: 'التكوير',
            82: 'الانفطار',
            83: 'المطففين',
            84: 'الانشقاق',
            85: 'البروج',
            86: 'الطارق',
            87: 'الأعلى',
            88: 'الغاشية',
            89: 'الفجر',
            90: 'البلد',
            91: 'الشمس',
            92: 'الليل',
            93: 'الضحى',
            94: 'الشرح',
            95: 'التين',
            96: 'العلق',
            97: 'القدر',
            98: 'البينة',
            99: 'الزلزلة',
            100: 'العاديات',
            101: 'القارعة',
            102: 'التكاثر',
            103: 'العصر',
            104: 'الهمزة',
            105: 'الفيل',
            106: 'قريش',
            107: 'الماعون',
            108: 'الكوثر',
            109: 'الكافرون',
            110: 'النصر',
            111: 'المسد',
            112: 'الإخلاص',
            113: 'الفلق',
            114: 'الناس'
        };

        function createCalendar() {
            const readPages = JSON.parse(localStorage.getItem('readPages') || '[]');
            calendar.innerHTML = '';
            
            for (let i = 1; i <= 604; i++) {
                const page = document.createElement('div');
                page.className = `page-number ${readPages.includes(i) ? 'read-page' : ''}`;
                page.textContent = i;
                page.onclick = () => loadPage(i);
                calendar.appendChild(page);
            }
        }

        async function loadPage(pageNumber) {
            try {
                currentPage = pageNumber;
                showSpinner();
                
                const response = await fetch(`https://api.alquran.cloud/v1/page/${pageNumber}/ar.alafasy`);
                const data = await response.json();
                
                const verses = data.data.ayahs;
                let content = '';
                let currentSurah = null;
                
                verses.forEach(ayah => {
                    const surahNumber = ayah.surah.number;
                    const surahName = surahNames[surahNumber] || `سورة ${surahNumber}`;
                    
                    if(currentSurah !== surahNumber) {
                        content += `<div class="surah-title">${surahName}</div>`;
                        currentSurah = surahNumber;
                    }
                    
                    content += `<p>${ayah.text} <span style="color: #3498db;">(${ayah.numberInSurah})</span></p>`;
                });

                document.getElementById('page-content').innerHTML = content;
                document.getElementById('modal').style.display = 'flex';
                updateMarkButton();
                hideSpinner();
            } catch (error) {
                alert('حدث خطأ أثناء تحميل الصفحة');
                console.error(error);
                hideSpinner();
            }
        }

        function togglePageMark() {
            const readPages = JSON.parse(localStorage.getItem('readPages') || '[]');
            const index = readPages.indexOf(currentPage);
            
            if (index === -1) {
                readPages.push(currentPage);
            } else {
                readPages.splice(index, 1);
            }
            
            localStorage.setItem('readPages', JSON.stringify(readPages));
            createCalendar();
            updateMarkButton();
            closeModal();
        }

        function updateMarkButton() {
            const readPages = JSON.parse(localStorage.getItem('readPages') || '[]');
            const btn = document.getElementById('markBtn');
            const isRead = readPages.includes(currentPage);
            
            btn.textContent = isRead ? 'إلغاء التمييز ✗' : 'تمت القراءة ✓';
            btn.classList.toggle('unmark-btn', isRead);
        }

        function showSpinner() {
            document.getElementById('spinner').style.display = 'block';
        }

        function hideSpinner() {
            document.getElementById('spinner').style.display = 'none';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }

        window.onclick = function(event) {
            const modal = document.getElementById('modal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }

        window.onload = () => {
            createCalendar();
        }
    </script>
</body>
</html>
